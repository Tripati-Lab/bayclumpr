<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>bayclumpr • bayclumpr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="bayclumpr">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bayclumpr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/bayclumpr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Tripati-Lab/bayclumpr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>bayclumpr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Tripati-Lab/bayclumpr/blob/HEAD/vignettes/bayclumpr.Rmd" class="external-link"><code>vignettes/bayclumpr.Rmd</code></a></small>
      <div class="d-none name"><code>bayclumpr.Rmd</code></div>
    </div>

    
    
<p>Welcome to <code>bayclumpr</code>! Before we get started with this
tutorial, we would like to remind you that there is an associated shiny
app that accompanies this <code>R</code> package. You can access
<code>BayClump</code> directly from your browser using by clicking <a href="https://bayclump.tripatilab.epss.ucla.edu/" class="external-link">here</a>. Now, let’s
go ahead and discuss some of the basic functions in
<code>bayclumpr</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bayclump.tripatilab.epss.ucla.edu/" class="external-link">bayclumpr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="performing-calibrations-using-bayclumpr">Performing calibrations using <code>bayclumpr</code><a class="anchor" aria-label="anchor" href="#performing-calibrations-using-bayclumpr"></a>
</h2>
<p>First, we will need some data to work with. We can use
<code>bayclumpr</code> to generate simulated datasets with uncertainty
values described in Roman-Palacios et al. (2022). For this example, we
will simulate 50 observations under a low-eror scenario. <strong>Note
that the functions in <code>bayclumpr</code> expect users to provide
uncertainty in terms of standard deviation.</strong> The resulting
dataset will be stored in the <code>ds</code> object.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cal.dataset.html">cal.dataset</a></span><span class="op">(</span>error <span class="op">=</span> <span class="st">"S1"</span>, nobs <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ds</span><span class="op">)</span></span>
<span><span class="co">#&gt;      x_TRUE Temperature    TempError    y_TRUE      D47error       D47 Material</span></span>
<span><span class="co">#&gt; 1 10.076133   10.089943  0.013809939 0.6475262 -0.0032283733 0.6442978        1</span></span>
<span><span class="co">#&gt; 2 11.414949   11.399569 -0.015379377 0.6841481  0.0065876134 0.6907357        1</span></span>
<span><span class="co">#&gt; 3 12.517576   12.522651  0.005074617 0.7430624  0.0012176807 0.7442800        1</span></span>
<span><span class="co">#&gt; 4  9.695736    9.662728 -0.033008011 0.6333012  0.0021347308 0.6354360        1</span></span>
<span><span class="co">#&gt; 5 12.391566   12.364749 -0.026817078 0.7379670  0.0027211068 0.7406881        1</span></span>
<span><span class="co">#&gt; 6 12.060248   12.051630 -0.008617473 0.7206252  0.0005650349 0.7211903        1</span></span></code></pre></div>
<p>Now, let’s start by fitting different models in the simulated
dataset. For instance, let’s fit a Deming regression model using the
<code>cal.deming</code> function in <code>bayclumpr</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cal.deming.html">cal.deming</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ds</span>, replicates <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;        alpha       beta</span></span>
<span><span class="co">#&gt; 1  0.2440497 0.03906877</span></span>
<span><span class="co">#&gt; 2  0.2614754 0.03670698</span></span>
<span><span class="co">#&gt; 3  0.2760968 0.03574009</span></span>
<span><span class="co">#&gt; 4  0.2419661 0.03857797</span></span>
<span><span class="co">#&gt; 5  0.2752911 0.03585697</span></span>
<span><span class="co">#&gt; 6  0.2526154 0.03764163</span></span>
<span><span class="co">#&gt; 7  0.2497403 0.03784485</span></span>
<span><span class="co">#&gt; 8  0.2505127 0.03785190</span></span>
<span><span class="co">#&gt; 9  0.2590315 0.03708834</span></span>
<span><span class="co">#&gt; 10 0.2057244 0.04158558</span></span></code></pre></div>
<p>Alternatively, you can fit an unweighted or weighted OLS regression
using <code>cal.ols</code> and <code>cal.wols</code> functions,
respectively:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cal.ols.html">cal.ols</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ds</span>, replicates <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;        alpha       beta</span></span>
<span><span class="co">#&gt; 1  0.2839352 0.03554307</span></span>
<span><span class="co">#&gt; 2  0.2872762 0.03527608</span></span>
<span><span class="co">#&gt; 3  0.2733101 0.03642586</span></span>
<span><span class="co">#&gt; 4  0.2640842 0.03709674</span></span>
<span><span class="co">#&gt; 5  0.2652946 0.03701428</span></span>
<span><span class="co">#&gt; 6  0.2668595 0.03679151</span></span>
<span><span class="co">#&gt; 7  0.2660233 0.03687870</span></span>
<span><span class="co">#&gt; 8  0.2826984 0.03542715</span></span>
<span><span class="co">#&gt; 9  0.2693398 0.03663859</span></span>
<span><span class="co">#&gt; 10 0.2850873 0.03507551</span></span>
<span><span class="fu"><a href="../reference/cal.wols.html">cal.wols</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ds</span>, replicates <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;        alpha       beta</span></span>
<span><span class="co">#&gt; 1  0.2557905 0.03789321</span></span>
<span><span class="co">#&gt; 2  0.2734807 0.03632590</span></span>
<span><span class="co">#&gt; 3  0.2716440 0.03643221</span></span>
<span><span class="co">#&gt; 4  0.2711929 0.03621119</span></span>
<span><span class="co">#&gt; 5  0.2743809 0.03625556</span></span>
<span><span class="co">#&gt; 6  0.2716777 0.03629290</span></span>
<span><span class="co">#&gt; 7  0.2765445 0.03604140</span></span>
<span><span class="co">#&gt; 8  0.2747726 0.03619440</span></span>
<span><span class="co">#&gt; 9  0.2710448 0.03650991</span></span>
<span><span class="co">#&gt; 10 0.2699076 0.03685035</span></span></code></pre></div>
<p>York regression models are also implemented in
<code>bayclumpr</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cal.york.html">cal.york</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ds</span>, replicates <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;        alpha       beta</span></span>
<span><span class="co">#&gt; 1  0.2502012 0.03822585</span></span>
<span><span class="co">#&gt; 2  0.2417208 0.03889872</span></span>
<span><span class="co">#&gt; 3  0.2430982 0.03835195</span></span>
<span><span class="co">#&gt; 4  0.2689329 0.03625636</span></span>
<span><span class="co">#&gt; 5  0.2714125 0.03611063</span></span>
<span><span class="co">#&gt; 6  0.2638400 0.03685362</span></span>
<span><span class="co">#&gt; 7  0.2897728 0.03520313</span></span>
<span><span class="co">#&gt; 8  0.2755461 0.03600768</span></span>
<span><span class="co">#&gt; 9  0.2630668 0.03715828</span></span>
<span><span class="co">#&gt; 10 0.2678943 0.03654801</span></span></code></pre></div>
<p>Finally, <code>bayclumpr</code> implements three types of Bayesian
linear models that are used for calibrations and temperature
reconstructions. Let’s fit all three models using the
<code>cal.bayesian</code> function:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>BayesCal <span class="ot">&lt;-</span> <span class="fu">cal.bayesian</span>(<span class="at">calibrationData =</span> ds, <span class="at">numSavedSteps =</span> <span class="dv">3000</span>, <span class="at">priors =</span> <span class="st">"Weak"</span>, <span class="at">MC =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>using C compiler<span class="sc">:</span> ‘Apple clang version <span class="dv">17</span>.<span class="fl">0.0</span> (clang<span class="dv">-1700</span>.<span class="dv">0</span>.<span class="fl">13.5</span>)’</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>\</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>using SDK<span class="sc">:</span> ‘MacOSX15.<span class="fl">5.</span>sdk’</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="sc">|</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>clang <span class="sc">-</span>arch arm64 <span class="sc">-</span>std<span class="ot">=</span>gnu2x <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Resources/include"</span> <span class="sc">-</span>DNDEBUG   <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/Rcpp/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/unsupported"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/BH/include"</span> <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/src/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppParallel/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/rstan/include"</span> <span class="sc">-</span>DEIGEN_NO_DEBUG  <span class="sc">-</span>DBOOST_DISABLE_ASSERTS  <span class="sc">-</span>DBOOST_PENDING_INTEGER_LOG2_HPP  <span class="sc">-</span>DSTAN_THREADS  <span class="sc">-</span>DUSE_STANC3 <span class="sc">-</span>DSTRICT_R_HEADERS  <span class="sc">-</span>DBOOST_PHOENIX_NO_VARIADIC_EXPRESSION  <span class="sc">-</span>D_HAS_AUTO_PTR_ETC<span class="ot">=</span><span class="dv">0</span>  <span class="sc">-</span>include <span class="st">'/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp'</span>  <span class="sc">-</span>D_REENTRANT <span class="sc">-</span>DRCPP_PARALLEL_USE_TBB<span class="ot">=</span><span class="dv">1</span>   <span class="sc">-</span>I<span class="sc">/</span>opt<span class="sc">/</span>R<span class="sc">/</span>arm64<span class="sc">/</span>include    <span class="sc">-</span>fPIC  <span class="sc">-</span>falign<span class="sc">-</span>functions<span class="ot">=</span><span class="dv">64</span> <span class="sc">-</span>Wall <span class="sc">-</span>g <span class="sc">-</span>O2  <span class="sc">-</span>c foo.c <span class="sc">-</span>o foo.o</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="sc">/</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>In file included from <span class="sc">&lt;</span>built<span class="sc">-</span><span class="cf">in</span><span class="sc">&gt;</span><span class="er">:</span><span class="dv">1</span><span class="sc">:</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22:</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/Dense:1:</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/Core:19:</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:679:10: fatal error: 'cmath' file not found</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt;   679 | #include &lt;cmath&gt;</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt;       |          ^~~~~~~</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="dv">1</span> error generated.</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>\</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>make<span class="sc">:</span> <span class="er">***</span> [foo.o] Error <span class="dv">1</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="sc">|</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="er">/</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a> </span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).</span></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a><span class="co">#&gt; Chain 1: Gradient evaluation took 4.4e-05 seconds</span></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.44 seconds.</span></span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:    1 / 2500 [  0%]  (Warmup)</span></span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:  250 / 2500 [ 10%]  (Warmup)</span></span>
<span id="cb6-42"><a href="#cb6-42" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:  500 / 2500 [ 20%]  (Warmup)</span></span>
<span id="cb6-43"><a href="#cb6-43" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:  750 / 2500 [ 30%]  (Warmup)</span></span>
<span id="cb6-44"><a href="#cb6-44" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1000 / 2500 [ 40%]  (Warmup)</span></span>
<span id="cb6-45"><a href="#cb6-45" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1001 / 2500 [ 40%]  (Sampling)</span></span>
<span id="cb6-46"><a href="#cb6-46" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1250 / 2500 [ 50%]  (Sampling)</span></span>
<span id="cb6-47"><a href="#cb6-47" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1500 / 2500 [ 60%]  (Sampling)</span></span>
<span id="cb6-48"><a href="#cb6-48" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1750 / 2500 [ 70%]  (Sampling)</span></span>
<span id="cb6-49"><a href="#cb6-49" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 2000 / 2500 [ 80%]  (Sampling)</span></span>
<span id="cb6-50"><a href="#cb6-50" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 2250 / 2500 [ 90%]  (Sampling)</span></span>
<span id="cb6-51"><a href="#cb6-51" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 2500 / 2500 [100%]  (Sampling)</span></span>
<span id="cb6-52"><a href="#cb6-52" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb6-53"><a href="#cb6-53" tabindex="-1"></a><span class="co">#&gt; Chain 1:  Elapsed Time: 0.548 seconds (Warm-up)</span></span>
<span id="cb6-54"><a href="#cb6-54" tabindex="-1"></a><span class="co">#&gt; Chain 1:                0.415 seconds (Sampling)</span></span>
<span id="cb6-55"><a href="#cb6-55" tabindex="-1"></a><span class="co">#&gt; Chain 1:                0.963 seconds (Total)</span></span>
<span id="cb6-56"><a href="#cb6-56" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb6-57"><a href="#cb6-57" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-58"><a href="#cb6-58" tabindex="-1"></a><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).</span></span>
<span id="cb6-59"><a href="#cb6-59" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb6-60"><a href="#cb6-60" tabindex="-1"></a><span class="co">#&gt; Chain 2: Gradient evaluation took 4e-06 seconds</span></span>
<span id="cb6-61"><a href="#cb6-61" tabindex="-1"></a><span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.04 seconds.</span></span>
<span id="cb6-62"><a href="#cb6-62" tabindex="-1"></a><span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span></span>
<span id="cb6-63"><a href="#cb6-63" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb6-64"><a href="#cb6-64" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb6-65"><a href="#cb6-65" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:    1 / 2500 [  0%]  (Warmup)</span></span>
<span id="cb6-66"><a href="#cb6-66" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:  250 / 2500 [ 10%]  (Warmup)</span></span>
<span id="cb6-67"><a href="#cb6-67" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:  500 / 2500 [ 20%]  (Warmup)</span></span>
<span id="cb6-68"><a href="#cb6-68" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:  750 / 2500 [ 30%]  (Warmup)</span></span>
<span id="cb6-69"><a href="#cb6-69" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1000 / 2500 [ 40%]  (Warmup)</span></span>
<span id="cb6-70"><a href="#cb6-70" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1001 / 2500 [ 40%]  (Sampling)</span></span>
<span id="cb6-71"><a href="#cb6-71" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1250 / 2500 [ 50%]  (Sampling)</span></span>
<span id="cb6-72"><a href="#cb6-72" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1500 / 2500 [ 60%]  (Sampling)</span></span>
<span id="cb6-73"><a href="#cb6-73" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1750 / 2500 [ 70%]  (Sampling)</span></span>
<span id="cb6-74"><a href="#cb6-74" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 2000 / 2500 [ 80%]  (Sampling)</span></span>
<span id="cb6-75"><a href="#cb6-75" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 2250 / 2500 [ 90%]  (Sampling)</span></span>
<span id="cb6-76"><a href="#cb6-76" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 2500 / 2500 [100%]  (Sampling)</span></span>
<span id="cb6-77"><a href="#cb6-77" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb6-78"><a href="#cb6-78" tabindex="-1"></a><span class="co">#&gt; Chain 2:  Elapsed Time: 0.444 seconds (Warm-up)</span></span>
<span id="cb6-79"><a href="#cb6-79" tabindex="-1"></a><span class="co">#&gt; Chain 2:                0.601 seconds (Sampling)</span></span>
<span id="cb6-80"><a href="#cb6-80" tabindex="-1"></a><span class="co">#&gt; Chain 2:                1.045 seconds (Total)</span></span>
<span id="cb6-81"><a href="#cb6-81" tabindex="-1"></a><span class="co">#&gt; Chain 2:</span></span>
<span id="cb6-82"><a href="#cb6-82" tabindex="-1"></a><span class="co">#&gt; Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c</span></span>
<span id="cb6-83"><a href="#cb6-83" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-84"><a href="#cb6-84" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb6-85"><a href="#cb6-85" tabindex="-1"></a></span>
<span id="cb6-86"><a href="#cb6-86" tabindex="-1"></a>\</span>
<span id="cb6-87"><a href="#cb6-87" tabindex="-1"></a>using C compiler<span class="sc">:</span> ‘Apple clang version <span class="dv">17</span>.<span class="fl">0.0</span> (clang<span class="dv">-1700</span>.<span class="dv">0</span>.<span class="fl">13.5</span>)’</span>
<span id="cb6-88"><a href="#cb6-88" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-89"><a href="#cb6-89" tabindex="-1"></a><span class="sc">|</span></span>
<span id="cb6-90"><a href="#cb6-90" tabindex="-1"></a>using SDK<span class="sc">:</span> ‘MacOSX15.<span class="fl">5.</span>sdk’</span>
<span id="cb6-91"><a href="#cb6-91" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-92"><a href="#cb6-92" tabindex="-1"></a><span class="sc">/</span></span>
<span id="cb6-93"><a href="#cb6-93" tabindex="-1"></a>clang <span class="sc">-</span>arch arm64 <span class="sc">-</span>std<span class="ot">=</span>gnu2x <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Resources/include"</span> <span class="sc">-</span>DNDEBUG   <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/Rcpp/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/unsupported"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/BH/include"</span> <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/src/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppParallel/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/rstan/include"</span> <span class="sc">-</span>DEIGEN_NO_DEBUG  <span class="sc">-</span>DBOOST_DISABLE_ASSERTS  <span class="sc">-</span>DBOOST_PENDING_INTEGER_LOG2_HPP  <span class="sc">-</span>DSTAN_THREADS  <span class="sc">-</span>DUSE_STANC3 <span class="sc">-</span>DSTRICT_R_HEADERS  <span class="sc">-</span>DBOOST_PHOENIX_NO_VARIADIC_EXPRESSION  <span class="sc">-</span>D_HAS_AUTO_PTR_ETC<span class="ot">=</span><span class="dv">0</span>  <span class="sc">-</span>include <span class="st">'/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp'</span>  <span class="sc">-</span>D_REENTRANT <span class="sc">-</span>DRCPP_PARALLEL_USE_TBB<span class="ot">=</span><span class="dv">1</span>   <span class="sc">-</span>I<span class="sc">/</span>opt<span class="sc">/</span>R<span class="sc">/</span>arm64<span class="sc">/</span>include    <span class="sc">-</span>fPIC  <span class="sc">-</span>falign<span class="sc">-</span>functions<span class="ot">=</span><span class="dv">64</span> <span class="sc">-</span>Wall <span class="sc">-</span>g <span class="sc">-</span>O2  <span class="sc">-</span>c foo.c <span class="sc">-</span>o foo.o</span>
<span id="cb6-94"><a href="#cb6-94" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-95"><a href="#cb6-95" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb6-96"><a href="#cb6-96" tabindex="-1"></a>In file included from <span class="sc">&lt;</span>built<span class="sc">-</span><span class="cf">in</span><span class="sc">&gt;</span><span class="er">:</span><span class="dv">1</span><span class="sc">:</span></span>
<span id="cb6-97"><a href="#cb6-97" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22:</span></span>
<span id="cb6-98"><a href="#cb6-98" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/Dense:1:</span></span>
<span id="cb6-99"><a href="#cb6-99" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/Core:19:</span></span>
<span id="cb6-100"><a href="#cb6-100" tabindex="-1"></a><span class="co">#&gt; /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:679:10: fatal error: 'cmath' file not found</span></span>
<span id="cb6-101"><a href="#cb6-101" tabindex="-1"></a><span class="co">#&gt;   679 | #include &lt;cmath&gt;</span></span>
<span id="cb6-102"><a href="#cb6-102" tabindex="-1"></a><span class="co">#&gt;       |          ^~~~~~~</span></span>
<span id="cb6-103"><a href="#cb6-103" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-104"><a href="#cb6-104" tabindex="-1"></a>\</span>
<span id="cb6-105"><a href="#cb6-105" tabindex="-1"></a><span class="dv">1</span> error generated.</span>
<span id="cb6-106"><a href="#cb6-106" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-107"><a href="#cb6-107" tabindex="-1"></a><span class="sc">|</span></span>
<span id="cb6-108"><a href="#cb6-108" tabindex="-1"></a>make<span class="sc">:</span> <span class="er">***</span> [foo.o] Error <span class="dv">1</span></span>
<span id="cb6-109"><a href="#cb6-109" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-110"><a href="#cb6-110" tabindex="-1"></a><span class="sc">/</span></span>
<span id="cb6-111"><a href="#cb6-111" tabindex="-1"></a></span>
<span id="cb6-112"><a href="#cb6-112" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb6-113"><a href="#cb6-113" tabindex="-1"></a></span>
<span id="cb6-114"><a href="#cb6-114" tabindex="-1"></a> </span>
<span id="cb6-115"><a href="#cb6-115" tabindex="-1"></a><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).</span></span>
<span id="cb6-116"><a href="#cb6-116" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb6-117"><a href="#cb6-117" tabindex="-1"></a><span class="co">#&gt; Chain 1: Gradient evaluation took 2e-05 seconds</span></span>
<span id="cb6-118"><a href="#cb6-118" tabindex="-1"></a><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.2 seconds.</span></span>
<span id="cb6-119"><a href="#cb6-119" tabindex="-1"></a><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb6-120"><a href="#cb6-120" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb6-121"><a href="#cb6-121" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb6-122"><a href="#cb6-122" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:    1 / 2500 [  0%]  (Warmup)</span></span>
<span id="cb6-123"><a href="#cb6-123" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:  250 / 2500 [ 10%]  (Warmup)</span></span>
<span id="cb6-124"><a href="#cb6-124" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:  500 / 2500 [ 20%]  (Warmup)</span></span>
<span id="cb6-125"><a href="#cb6-125" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:  750 / 2500 [ 30%]  (Warmup)</span></span>
<span id="cb6-126"><a href="#cb6-126" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1000 / 2500 [ 40%]  (Warmup)</span></span>
<span id="cb6-127"><a href="#cb6-127" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1001 / 2500 [ 40%]  (Sampling)</span></span>
<span id="cb6-128"><a href="#cb6-128" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1250 / 2500 [ 50%]  (Sampling)</span></span>
<span id="cb6-129"><a href="#cb6-129" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1500 / 2500 [ 60%]  (Sampling)</span></span>
<span id="cb6-130"><a href="#cb6-130" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1750 / 2500 [ 70%]  (Sampling)</span></span>
<span id="cb6-131"><a href="#cb6-131" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 2000 / 2500 [ 80%]  (Sampling)</span></span>
<span id="cb6-132"><a href="#cb6-132" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 2250 / 2500 [ 90%]  (Sampling)</span></span>
<span id="cb6-133"><a href="#cb6-133" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 2500 / 2500 [100%]  (Sampling)</span></span>
<span id="cb6-134"><a href="#cb6-134" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb6-135"><a href="#cb6-135" tabindex="-1"></a><span class="co">#&gt; Chain 1:  Elapsed Time: 0.106 seconds (Warm-up)</span></span>
<span id="cb6-136"><a href="#cb6-136" tabindex="-1"></a><span class="co">#&gt; Chain 1:                0.108 seconds (Sampling)</span></span>
<span id="cb6-137"><a href="#cb6-137" tabindex="-1"></a><span class="co">#&gt; Chain 1:                0.214 seconds (Total)</span></span>
<span id="cb6-138"><a href="#cb6-138" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb6-139"><a href="#cb6-139" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-140"><a href="#cb6-140" tabindex="-1"></a><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).</span></span>
<span id="cb6-141"><a href="#cb6-141" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb6-142"><a href="#cb6-142" tabindex="-1"></a><span class="co">#&gt; Chain 2: Gradient evaluation took 2e-06 seconds</span></span>
<span id="cb6-143"><a href="#cb6-143" tabindex="-1"></a><span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.02 seconds.</span></span>
<span id="cb6-144"><a href="#cb6-144" tabindex="-1"></a><span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span></span>
<span id="cb6-145"><a href="#cb6-145" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb6-146"><a href="#cb6-146" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb6-147"><a href="#cb6-147" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:    1 / 2500 [  0%]  (Warmup)</span></span>
<span id="cb6-148"><a href="#cb6-148" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:  250 / 2500 [ 10%]  (Warmup)</span></span>
<span id="cb6-149"><a href="#cb6-149" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:  500 / 2500 [ 20%]  (Warmup)</span></span>
<span id="cb6-150"><a href="#cb6-150" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:  750 / 2500 [ 30%]  (Warmup)</span></span>
<span id="cb6-151"><a href="#cb6-151" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1000 / 2500 [ 40%]  (Warmup)</span></span>
<span id="cb6-152"><a href="#cb6-152" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1001 / 2500 [ 40%]  (Sampling)</span></span>
<span id="cb6-153"><a href="#cb6-153" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1250 / 2500 [ 50%]  (Sampling)</span></span>
<span id="cb6-154"><a href="#cb6-154" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1500 / 2500 [ 60%]  (Sampling)</span></span>
<span id="cb6-155"><a href="#cb6-155" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1750 / 2500 [ 70%]  (Sampling)</span></span>
<span id="cb6-156"><a href="#cb6-156" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 2000 / 2500 [ 80%]  (Sampling)</span></span>
<span id="cb6-157"><a href="#cb6-157" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 2250 / 2500 [ 90%]  (Sampling)</span></span>
<span id="cb6-158"><a href="#cb6-158" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 2500 / 2500 [100%]  (Sampling)</span></span>
<span id="cb6-159"><a href="#cb6-159" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb6-160"><a href="#cb6-160" tabindex="-1"></a><span class="co">#&gt; Chain 2:  Elapsed Time: 0.158 seconds (Warm-up)</span></span>
<span id="cb6-161"><a href="#cb6-161" tabindex="-1"></a><span class="co">#&gt; Chain 2:                0.131 seconds (Sampling)</span></span>
<span id="cb6-162"><a href="#cb6-162" tabindex="-1"></a><span class="co">#&gt; Chain 2:                0.289 seconds (Total)</span></span>
<span id="cb6-163"><a href="#cb6-163" tabindex="-1"></a><span class="co">#&gt; Chain 2:</span></span>
<span id="cb6-164"><a href="#cb6-164" tabindex="-1"></a><span class="co">#&gt; Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c</span></span>
<span id="cb6-165"><a href="#cb6-165" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-166"><a href="#cb6-166" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb6-167"><a href="#cb6-167" tabindex="-1"></a></span>
<span id="cb6-168"><a href="#cb6-168" tabindex="-1"></a>\</span>
<span id="cb6-169"><a href="#cb6-169" tabindex="-1"></a>using C compiler<span class="sc">:</span> ‘Apple clang version <span class="dv">17</span>.<span class="fl">0.0</span> (clang<span class="dv">-1700</span>.<span class="dv">0</span>.<span class="fl">13.5</span>)’</span>
<span id="cb6-170"><a href="#cb6-170" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-171"><a href="#cb6-171" tabindex="-1"></a><span class="sc">|</span></span>
<span id="cb6-172"><a href="#cb6-172" tabindex="-1"></a>using SDK<span class="sc">:</span> ‘MacOSX15.<span class="fl">5.</span>sdk’</span>
<span id="cb6-173"><a href="#cb6-173" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-174"><a href="#cb6-174" tabindex="-1"></a><span class="sc">/</span></span>
<span id="cb6-175"><a href="#cb6-175" tabindex="-1"></a>clang <span class="sc">-</span>arch arm64 <span class="sc">-</span>std<span class="ot">=</span>gnu2x <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Resources/include"</span> <span class="sc">-</span>DNDEBUG   <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/Rcpp/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/unsupported"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/BH/include"</span> <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/src/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppParallel/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/rstan/include"</span> <span class="sc">-</span>DEIGEN_NO_DEBUG  <span class="sc">-</span>DBOOST_DISABLE_ASSERTS  <span class="sc">-</span>DBOOST_PENDING_INTEGER_LOG2_HPP  <span class="sc">-</span>DSTAN_THREADS  <span class="sc">-</span>DUSE_STANC3 <span class="sc">-</span>DSTRICT_R_HEADERS  <span class="sc">-</span>DBOOST_PHOENIX_NO_VARIADIC_EXPRESSION  <span class="sc">-</span>D_HAS_AUTO_PTR_ETC<span class="ot">=</span><span class="dv">0</span>  <span class="sc">-</span>include <span class="st">'/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp'</span>  <span class="sc">-</span>D_REENTRANT <span class="sc">-</span>DRCPP_PARALLEL_USE_TBB<span class="ot">=</span><span class="dv">1</span>   <span class="sc">-</span>I<span class="sc">/</span>opt<span class="sc">/</span>R<span class="sc">/</span>arm64<span class="sc">/</span>include    <span class="sc">-</span>fPIC  <span class="sc">-</span>falign<span class="sc">-</span>functions<span class="ot">=</span><span class="dv">64</span> <span class="sc">-</span>Wall <span class="sc">-</span>g <span class="sc">-</span>O2  <span class="sc">-</span>c foo.c <span class="sc">-</span>o foo.o</span>
<span id="cb6-176"><a href="#cb6-176" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-177"><a href="#cb6-177" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb6-178"><a href="#cb6-178" tabindex="-1"></a>In file included from <span class="sc">&lt;</span>built<span class="sc">-</span><span class="cf">in</span><span class="sc">&gt;</span><span class="er">:</span><span class="dv">1</span><span class="sc">:</span></span>
<span id="cb6-179"><a href="#cb6-179" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22:</span></span>
<span id="cb6-180"><a href="#cb6-180" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/Dense:1:</span></span>
<span id="cb6-181"><a href="#cb6-181" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/Core:19:</span></span>
<span id="cb6-182"><a href="#cb6-182" tabindex="-1"></a><span class="co">#&gt; /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:679:10: fatal error: 'cmath' file not found</span></span>
<span id="cb6-183"><a href="#cb6-183" tabindex="-1"></a><span class="co">#&gt;   679 | #include &lt;cmath&gt;</span></span>
<span id="cb6-184"><a href="#cb6-184" tabindex="-1"></a><span class="co">#&gt;       |          ^~~~~~~</span></span>
<span id="cb6-185"><a href="#cb6-185" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-186"><a href="#cb6-186" tabindex="-1"></a>\</span>
<span id="cb6-187"><a href="#cb6-187" tabindex="-1"></a><span class="dv">1</span> error generated.</span>
<span id="cb6-188"><a href="#cb6-188" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-189"><a href="#cb6-189" tabindex="-1"></a><span class="sc">|</span></span>
<span id="cb6-190"><a href="#cb6-190" tabindex="-1"></a>make<span class="sc">:</span> <span class="er">***</span> [foo.o] Error <span class="dv">1</span></span>
<span id="cb6-191"><a href="#cb6-191" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-192"><a href="#cb6-192" tabindex="-1"></a><span class="sc">/</span></span>
<span id="cb6-193"><a href="#cb6-193" tabindex="-1"></a></span>
<span id="cb6-194"><a href="#cb6-194" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb6-195"><a href="#cb6-195" tabindex="-1"></a></span>
<span id="cb6-196"><a href="#cb6-196" tabindex="-1"></a> </span>
<span id="cb6-197"><a href="#cb6-197" tabindex="-1"></a><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).</span></span>
<span id="cb6-198"><a href="#cb6-198" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb6-199"><a href="#cb6-199" tabindex="-1"></a><span class="co">#&gt; Chain 1: Gradient evaluation took 2.7e-05 seconds</span></span>
<span id="cb6-200"><a href="#cb6-200" tabindex="-1"></a><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.27 seconds.</span></span>
<span id="cb6-201"><a href="#cb6-201" tabindex="-1"></a><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb6-202"><a href="#cb6-202" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb6-203"><a href="#cb6-203" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb6-204"><a href="#cb6-204" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:    1 / 2500 [  0%]  (Warmup)</span></span>
<span id="cb6-205"><a href="#cb6-205" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:  250 / 2500 [ 10%]  (Warmup)</span></span>
<span id="cb6-206"><a href="#cb6-206" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:  500 / 2500 [ 20%]  (Warmup)</span></span>
<span id="cb6-207"><a href="#cb6-207" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:  750 / 2500 [ 30%]  (Warmup)</span></span>
<span id="cb6-208"><a href="#cb6-208" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1000 / 2500 [ 40%]  (Warmup)</span></span>
<span id="cb6-209"><a href="#cb6-209" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1001 / 2500 [ 40%]  (Sampling)</span></span>
<span id="cb6-210"><a href="#cb6-210" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1250 / 2500 [ 50%]  (Sampling)</span></span>
<span id="cb6-211"><a href="#cb6-211" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1500 / 2500 [ 60%]  (Sampling)</span></span>
<span id="cb6-212"><a href="#cb6-212" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1750 / 2500 [ 70%]  (Sampling)</span></span>
<span id="cb6-213"><a href="#cb6-213" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 2000 / 2500 [ 80%]  (Sampling)</span></span>
<span id="cb6-214"><a href="#cb6-214" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 2250 / 2500 [ 90%]  (Sampling)</span></span>
<span id="cb6-215"><a href="#cb6-215" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 2500 / 2500 [100%]  (Sampling)</span></span>
<span id="cb6-216"><a href="#cb6-216" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb6-217"><a href="#cb6-217" tabindex="-1"></a><span class="co">#&gt; Chain 1:  Elapsed Time: 0.228 seconds (Warm-up)</span></span>
<span id="cb6-218"><a href="#cb6-218" tabindex="-1"></a><span class="co">#&gt; Chain 1:                0.193 seconds (Sampling)</span></span>
<span id="cb6-219"><a href="#cb6-219" tabindex="-1"></a><span class="co">#&gt; Chain 1:                0.421 seconds (Total)</span></span>
<span id="cb6-220"><a href="#cb6-220" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb6-221"><a href="#cb6-221" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-222"><a href="#cb6-222" tabindex="-1"></a><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).</span></span>
<span id="cb6-223"><a href="#cb6-223" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb6-224"><a href="#cb6-224" tabindex="-1"></a><span class="co">#&gt; Chain 2: Gradient evaluation took 5e-06 seconds</span></span>
<span id="cb6-225"><a href="#cb6-225" tabindex="-1"></a><span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.05 seconds.</span></span>
<span id="cb6-226"><a href="#cb6-226" tabindex="-1"></a><span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span></span>
<span id="cb6-227"><a href="#cb6-227" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb6-228"><a href="#cb6-228" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb6-229"><a href="#cb6-229" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:    1 / 2500 [  0%]  (Warmup)</span></span>
<span id="cb6-230"><a href="#cb6-230" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:  250 / 2500 [ 10%]  (Warmup)</span></span>
<span id="cb6-231"><a href="#cb6-231" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:  500 / 2500 [ 20%]  (Warmup)</span></span>
<span id="cb6-232"><a href="#cb6-232" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:  750 / 2500 [ 30%]  (Warmup)</span></span>
<span id="cb6-233"><a href="#cb6-233" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1000 / 2500 [ 40%]  (Warmup)</span></span>
<span id="cb6-234"><a href="#cb6-234" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1001 / 2500 [ 40%]  (Sampling)</span></span>
<span id="cb6-235"><a href="#cb6-235" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1250 / 2500 [ 50%]  (Sampling)</span></span>
<span id="cb6-236"><a href="#cb6-236" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1500 / 2500 [ 60%]  (Sampling)</span></span>
<span id="cb6-237"><a href="#cb6-237" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1750 / 2500 [ 70%]  (Sampling)</span></span>
<span id="cb6-238"><a href="#cb6-238" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 2000 / 2500 [ 80%]  (Sampling)</span></span>
<span id="cb6-239"><a href="#cb6-239" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 2250 / 2500 [ 90%]  (Sampling)</span></span>
<span id="cb6-240"><a href="#cb6-240" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 2500 / 2500 [100%]  (Sampling)</span></span>
<span id="cb6-241"><a href="#cb6-241" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb6-242"><a href="#cb6-242" tabindex="-1"></a><span class="co">#&gt; Chain 2:  Elapsed Time: 0.228 seconds (Warm-up)</span></span>
<span id="cb6-243"><a href="#cb6-243" tabindex="-1"></a><span class="co">#&gt; Chain 2:                0.18 seconds (Sampling)</span></span>
<span id="cb6-244"><a href="#cb6-244" tabindex="-1"></a><span class="co">#&gt; Chain 2:                0.408 seconds (Total)</span></span>
<span id="cb6-245"><a href="#cb6-245" tabindex="-1"></a><span class="co">#&gt; Chain 2:</span></span></code></pre></div>
<p>The results are here stored in the <code>BayesCal</code> object and
corresponds to <code>stan</code> objects summarizing posterior
distributions of the parameters:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BayesCal</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="reconstructing-temperatures-in-bayclumpr">Reconstructing temperatures in <code>bayclumpr</code><a class="anchor" aria-label="anchor" href="#reconstructing-temperatures-in-bayclumpr"></a>
</h2>
<p><code>bayclumpr</code> implements two functions to perform
temperature reconstructions under frequentist (<code>rec.clumped</code>)
and Bayesian frameworks (<code>rec.bayesian</code>). Let’s review how
each of these functions work by generating a synthetic dataset for two
samples.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">recData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Sample"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span>,</span>
<span>                      D47 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                      D47error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.005</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.02</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">9</span><span class="op">)</span>,</span>
<span>                      Material <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>As for the calibration step, <code>bayclumpr</code> expects
uncertainty (<code>D47error</code>) to be expressed in terms of standard
deviation. Note that the <code>recData</code> object generated above
includes the smallest number of columns that are needed to perform
reconstructions in <code>bayclumpr</code>.</p>
<p>From this point, we will need to either specify the distribution of
parameter estimates from the calibration step. For instance, let’s
assume that we were interested in reconstructing temperatures for our
<code>recData</code> under an OLS model. First, we would have to run our
calibration analyses:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paramdist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cal.ols.html">cal.ols</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ds</span>, replicates <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>From this point, we can use the <code>rec.clumped</code> to
reconstruct temperatures based on the reconstruction dataset
(<code>recData</code> argument) and the observed calibration object
(<code>obCal</code> argument):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rec.clumped.html">rec.clumped</a></span><span class="op">(</span>recData <span class="op">=</span> <span class="va">recData</span>, obCal <span class="op">=</span> <span class="va">paramdist</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Sample D47 D47error  meanTemp    error</span></span>
<span><span class="co">#&gt; 1 Sample 1 0.6    0.005  59.79108 2.509437</span></span>
<span><span class="co">#&gt; 2 Sample 2 0.7    0.005  18.30648 1.687880</span></span>
<span><span class="co">#&gt; 3 Sample 3 0.8    0.005 -10.74432 1.233827</span></span>
<span><span class="co">#&gt; 4 Sample 4 0.6    0.010  59.79108 4.962974</span></span>
<span><span class="co">#&gt; 5 Sample 5 0.7    0.010  18.30648 3.346772</span></span>
<span><span class="co">#&gt; 6 Sample 6 0.8    0.010 -10.74432 2.450411</span></span>
<span><span class="co">#&gt; 7 Sample 7 0.6    0.020  59.79108 9.710425</span></span>
<span><span class="co">#&gt; 8 Sample 8 0.7    0.020  18.30648 6.580837</span></span>
<span><span class="co">#&gt; 9 Sample 9 0.8    0.020 -10.74432 4.833432</span></span></code></pre></div>
<p>The resulting object includes information from the template
reconstruction dataset but also information on the reconstructed
temperature and associated uncertainty (<code>1 SD</code>). Let’s now
perform reconstructions but under a Bayesian framework. For this, we
will again need parameter estimates derived from the calibration step
(see the <code>BayesCal</code> created above). We will perform
reconstructions under only a single of the Bayesian models equivalent to
the OLS but fit under a Bayesian framework
(<code>BayesCal$BLM1_fit_NoErrors</code>).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>PredsBay <span class="ot">&lt;-</span> <span class="fu">rec.bayesian</span>(<span class="at">calModel =</span> BayesCal<span class="sc">$</span>BLM1_fit_NoErrors, <span class="at">recData =</span> recData, <span class="at">iter =</span> <span class="dv">1000</span>, <span class="at">postcalsamples =</span> <span class="dv">100</span>, <span class="at">MC =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt; Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>\</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>using C compiler<span class="sc">:</span> ‘Apple clang version <span class="dv">17</span>.<span class="fl">0.0</span> (clang<span class="dv">-1700</span>.<span class="dv">0</span>.<span class="fl">13.5</span>)’</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="sc">|</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>using SDK<span class="sc">:</span> ‘MacOSX15.<span class="fl">5.</span>sdk’</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="sc">/</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>clang <span class="sc">-</span>arch arm64 <span class="sc">-</span>std<span class="ot">=</span>gnu2x <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Resources/include"</span> <span class="sc">-</span>DNDEBUG   <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/Rcpp/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/unsupported"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/BH/include"</span> <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/src/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppParallel/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/rstan/include"</span> <span class="sc">-</span>DEIGEN_NO_DEBUG  <span class="sc">-</span>DBOOST_DISABLE_ASSERTS  <span class="sc">-</span>DBOOST_PENDING_INTEGER_LOG2_HPP  <span class="sc">-</span>DSTAN_THREADS  <span class="sc">-</span>DUSE_STANC3 <span class="sc">-</span>DSTRICT_R_HEADERS  <span class="sc">-</span>DBOOST_PHOENIX_NO_VARIADIC_EXPRESSION  <span class="sc">-</span>D_HAS_AUTO_PTR_ETC<span class="ot">=</span><span class="dv">0</span>  <span class="sc">-</span>include <span class="st">'/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp'</span>  <span class="sc">-</span>D_REENTRANT <span class="sc">-</span>DRCPP_PARALLEL_USE_TBB<span class="ot">=</span><span class="dv">1</span>   <span class="sc">-</span>I<span class="sc">/</span>opt<span class="sc">/</span>R<span class="sc">/</span>arm64<span class="sc">/</span>include    <span class="sc">-</span>fPIC  <span class="sc">-</span>falign<span class="sc">-</span>functions<span class="ot">=</span><span class="dv">64</span> <span class="sc">-</span>Wall <span class="sc">-</span>g <span class="sc">-</span>O2  <span class="sc">-</span>c foo.c <span class="sc">-</span>o foo.o</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>In file included from <span class="sc">&lt;</span>built<span class="sc">-</span><span class="cf">in</span><span class="sc">&gt;</span><span class="er">:</span><span class="dv">1</span><span class="sc">:</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22:</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/Dense:1:</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/Core:19:</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt; /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:679:10: fatal error: 'cmath' file not found</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt;   679 | #include &lt;cmath&gt;</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt;       |          ^~~~~~~</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>\</span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="dv">1</span> error generated.</span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a><span class="sc">|</span></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a>make<span class="sc">:</span> <span class="er">***</span> [foo.o] Error <span class="dv">1</span></span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="sc">/</span></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a> </span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).</span></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a><span class="co">#&gt; Chain 1: Gradient evaluation took 4.9e-05 seconds</span></span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.49 seconds.</span></span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)</span></span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)</span></span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)</span></span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)</span></span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)</span></span>
<span id="cb11-47"><a href="#cb11-47" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)</span></span>
<span id="cb11-48"><a href="#cb11-48" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)</span></span>
<span id="cb11-49"><a href="#cb11-49" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)</span></span>
<span id="cb11-50"><a href="#cb11-50" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)</span></span>
<span id="cb11-51"><a href="#cb11-51" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)</span></span>
<span id="cb11-52"><a href="#cb11-52" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)</span></span>
<span id="cb11-53"><a href="#cb11-53" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)</span></span>
<span id="cb11-54"><a href="#cb11-54" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb11-55"><a href="#cb11-55" tabindex="-1"></a><span class="co">#&gt; Chain 1:  Elapsed Time: 0.356 seconds (Warm-up)</span></span>
<span id="cb11-56"><a href="#cb11-56" tabindex="-1"></a><span class="co">#&gt; Chain 1:                0.296 seconds (Sampling)</span></span>
<span id="cb11-57"><a href="#cb11-57" tabindex="-1"></a><span class="co">#&gt; Chain 1:                0.652 seconds (Total)</span></span>
<span id="cb11-58"><a href="#cb11-58" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb11-59"><a href="#cb11-59" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-60"><a href="#cb11-60" tabindex="-1"></a><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).</span></span>
<span id="cb11-61"><a href="#cb11-61" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb11-62"><a href="#cb11-62" tabindex="-1"></a><span class="co">#&gt; Chain 2: Gradient evaluation took 2.5e-05 seconds</span></span>
<span id="cb11-63"><a href="#cb11-63" tabindex="-1"></a><span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.25 seconds.</span></span>
<span id="cb11-64"><a href="#cb11-64" tabindex="-1"></a><span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span></span>
<span id="cb11-65"><a href="#cb11-65" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb11-66"><a href="#cb11-66" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb11-67"><a href="#cb11-67" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)</span></span>
<span id="cb11-68"><a href="#cb11-68" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 100 / 1000 [ 10%]  (Warmup)</span></span>
<span id="cb11-69"><a href="#cb11-69" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 200 / 1000 [ 20%]  (Warmup)</span></span>
<span id="cb11-70"><a href="#cb11-70" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 300 / 1000 [ 30%]  (Warmup)</span></span>
<span id="cb11-71"><a href="#cb11-71" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 400 / 1000 [ 40%]  (Warmup)</span></span>
<span id="cb11-72"><a href="#cb11-72" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 500 / 1000 [ 50%]  (Warmup)</span></span>
<span id="cb11-73"><a href="#cb11-73" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 501 / 1000 [ 50%]  (Sampling)</span></span>
<span id="cb11-74"><a href="#cb11-74" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 600 / 1000 [ 60%]  (Sampling)</span></span>
<span id="cb11-75"><a href="#cb11-75" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 700 / 1000 [ 70%]  (Sampling)</span></span>
<span id="cb11-76"><a href="#cb11-76" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 800 / 1000 [ 80%]  (Sampling)</span></span>
<span id="cb11-77"><a href="#cb11-77" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 900 / 1000 [ 90%]  (Sampling)</span></span>
<span id="cb11-78"><a href="#cb11-78" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)</span></span>
<span id="cb11-79"><a href="#cb11-79" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb11-80"><a href="#cb11-80" tabindex="-1"></a><span class="co">#&gt; Chain 2:  Elapsed Time: 0.361 seconds (Warm-up)</span></span>
<span id="cb11-81"><a href="#cb11-81" tabindex="-1"></a><span class="co">#&gt; Chain 2:                0.287 seconds (Sampling)</span></span>
<span id="cb11-82"><a href="#cb11-82" tabindex="-1"></a><span class="co">#&gt; Chain 2:                0.648 seconds (Total)</span></span>
<span id="cb11-83"><a href="#cb11-83" tabindex="-1"></a><span class="co">#&gt; Chain 2:</span></span></code></pre></div>
<p>The associated reconstructions to this Bayesian model are shown
below:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PredsBay</span></span>
<span><span class="co">#&gt;     Sample D47 D47error  meanTemp     error</span></span>
<span><span class="co">#&gt; 1 Sample 1 0.6    0.005  59.90427 0.7458333</span></span>
<span><span class="co">#&gt; 2 Sample 2 0.7    0.005  18.79649 0.5126213</span></span>
<span><span class="co">#&gt; 3 Sample 3 0.8    0.005 -10.10401 0.3495575</span></span>
<span><span class="co">#&gt; 4 Sample 4 0.6    0.010  59.91790 0.9299128</span></span>
<span><span class="co">#&gt; 5 Sample 5 0.7    0.010  18.77388 0.5521208</span></span>
<span><span class="co">#&gt; 6 Sample 6 0.8    0.010 -10.10330 0.4009682</span></span>
<span><span class="co">#&gt; 7 Sample 7 0.6    0.020  59.92347 1.2724674</span></span>
<span><span class="co">#&gt; 8 Sample 8 0.7    0.020  18.78675 0.8500821</span></span>
<span><span class="co">#&gt; 9 Sample 9 0.8    0.020 -10.10630 0.5857574</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="including-a-co-variate-with-error-in-the-covariate">Including a co-variate (with error in the covariate)<a class="anchor" aria-label="anchor" href="#including-a-co-variate-with-error-in-the-covariate"></a>
</h2>
<p>Now, instead of having a single predictor, we will use a second
column (i.e., Ion) and it’s error (i.e., IonError) as predictors. Let’s
first create a calibration dataset.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cal.dataset.html">cal.dataset</a></span><span class="op">(</span>error <span class="op">=</span> <span class="st">"S1"</span>, nobs <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p>Note that we will be using not super informative values for Ion and
its error. We just need to include those two new columns in the
dataset:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds</span><span class="op">$</span><span class="va">Ion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ds</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ds</span><span class="op">$</span><span class="va">IonError</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ds</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>At this point, we can fit the regression model that accounts for
uncertainty in each of the two predictors</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>ionmodel <span class="ot">&lt;-</span> <span class="fu">cal.ion.bayesian</span>(<span class="at">calibrationData =</span> ds, <span class="at">useIonError =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co">#&gt; Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>using C compiler<span class="sc">:</span> ‘Apple clang version <span class="dv">17</span>.<span class="fl">0.0</span> (clang<span class="dv">-1700</span>.<span class="dv">0</span>.<span class="fl">13.5</span>)’</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>\</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>using SDK<span class="sc">:</span> ‘MacOSX15.<span class="fl">5.</span>sdk’</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="sc">|</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>clang <span class="sc">-</span>arch arm64 <span class="sc">-</span>std<span class="ot">=</span>gnu2x <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Resources/include"</span> <span class="sc">-</span>DNDEBUG   <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/Rcpp/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/unsupported"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/BH/include"</span> <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/src/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppParallel/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/rstan/include"</span> <span class="sc">-</span>DEIGEN_NO_DEBUG  <span class="sc">-</span>DBOOST_DISABLE_ASSERTS  <span class="sc">-</span>DBOOST_PENDING_INTEGER_LOG2_HPP  <span class="sc">-</span>DSTAN_THREADS  <span class="sc">-</span>DUSE_STANC3 <span class="sc">-</span>DSTRICT_R_HEADERS  <span class="sc">-</span>DBOOST_PHOENIX_NO_VARIADIC_EXPRESSION  <span class="sc">-</span>D_HAS_AUTO_PTR_ETC<span class="ot">=</span><span class="dv">0</span>  <span class="sc">-</span>include <span class="st">'/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp'</span>  <span class="sc">-</span>D_REENTRANT <span class="sc">-</span>DRCPP_PARALLEL_USE_TBB<span class="ot">=</span><span class="dv">1</span>   <span class="sc">-</span>I<span class="sc">/</span>opt<span class="sc">/</span>R<span class="sc">/</span>arm64<span class="sc">/</span>include    <span class="sc">-</span>fPIC  <span class="sc">-</span>falign<span class="sc">-</span>functions<span class="ot">=</span><span class="dv">64</span> <span class="sc">-</span>Wall <span class="sc">-</span>g <span class="sc">-</span>O2  <span class="sc">-</span>c foo.c <span class="sc">-</span>o foo.o</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="sc">/</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>In file included from <span class="sc">&lt;</span>built<span class="sc">-</span><span class="cf">in</span><span class="sc">&gt;</span><span class="er">:</span><span class="dv">1</span><span class="sc">:</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22:</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/Dense:1:</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/Core:19:</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:679:10: fatal error: 'cmath' file not found</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt;   679 | #include &lt;cmath&gt;</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt;       |          ^~~~~~~</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="dv">1</span> error generated.</span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a>\</span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a>make<span class="sc">:</span> <span class="er">***</span> [foo.o] Error <span class="dv">1</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a><span class="sc">|</span></span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a></span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a><span class="er">/</span></span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a></span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a> </span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a>ionmodel</span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a><span class="co">#&gt; $BLM1_fit</span></span>
<span id="cb15-35"><a href="#cb15-35" tabindex="-1"></a><span class="co">#&gt; Inference for Stan model: anon_model.</span></span>
<span id="cb15-36"><a href="#cb15-36" tabindex="-1"></a><span class="co">#&gt; 2 chains, each with iter=2500; warmup=1000; thin=1; </span></span>
<span id="cb15-37"><a href="#cb15-37" tabindex="-1"></a><span class="co">#&gt; post-warmup draws per chain=1500, total post-warmup draws=3000.</span></span>
<span id="cb15-38"><a href="#cb15-38" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-39"><a href="#cb15-39" tabindex="-1"></a><span class="co">#&gt;        mean se_mean   sd  2.5%   25%   50%    75%  97.5% n_eff Rhat</span></span>
<span id="cb15-40"><a href="#cb15-40" tabindex="-1"></a><span class="co">#&gt; alpha  0.27    0.00 0.01  0.24  0.26  0.27   0.28   0.30  6450    1</span></span>
<span id="cb15-41"><a href="#cb15-41" tabindex="-1"></a><span class="co">#&gt; beta   0.04    0.00 0.00  0.03  0.04  0.04   0.04   0.04  6339    1</span></span>
<span id="cb15-42"><a href="#cb15-42" tabindex="-1"></a><span class="co">#&gt; gamma  0.00    0.00 0.00 -0.01  0.00  0.00   0.00   0.00  1793    1</span></span>
<span id="cb15-43"><a href="#cb15-43" tabindex="-1"></a><span class="co">#&gt; sigma  0.01    0.00 0.00  0.01  0.01  0.01   0.01   0.02  4431    1</span></span>
<span id="cb15-44"><a href="#cb15-44" tabindex="-1"></a><span class="co">#&gt; lp__  99.57    0.26 7.16 84.74 94.80 99.82 104.67 112.48   776    1</span></span>
<span id="cb15-45"><a href="#cb15-45" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-46"><a href="#cb15-46" tabindex="-1"></a><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Tue Jul 22 08:02:28 2025.</span></span>
<span id="cb15-47"><a href="#cb15-47" tabindex="-1"></a><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span id="cb15-48"><a href="#cb15-48" tabindex="-1"></a><span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span></span>
<span id="cb15-49"><a href="#cb15-49" tabindex="-1"></a><span class="co">#&gt; convergence, Rhat=1).</span></span></code></pre></div>
<p>From here, we can simply run a reconstruction based on a synthetic
reconstruction dataset with the following structure:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">recData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Sample"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span>,</span>
<span>                      D47 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                      D47error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.005</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.02</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      Ion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                      IonError <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.005</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.02</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">9</span><span class="op">)</span>,</span>
<span>                      Material <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The reconstruction can be performed as follows:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>PredsBay <span class="ot">&lt;-</span> <span class="fu">rec.ion.bayesian</span>(<span class="at">calModel =</span> ionmodel[[<span class="dv">1</span>]],</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>                         <span class="at">recData =</span> recData,</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>                         <span class="at">iter =</span> <span class="dv">1000</span>,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>                         <span class="at">postcalsamples =</span> <span class="dv">100</span>, <span class="at">MC =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt; Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>\</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>using C compiler<span class="sc">:</span> ‘Apple clang version <span class="dv">17</span>.<span class="fl">0.0</span> (clang<span class="dv">-1700</span>.<span class="dv">0</span>.<span class="fl">13.5</span>)’</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="sc">|</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>using SDK<span class="sc">:</span> ‘MacOSX15.<span class="fl">5.</span>sdk’</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="sc">/</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>clang <span class="sc">-</span>arch arm64 <span class="sc">-</span>std<span class="ot">=</span>gnu2x <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Resources/include"</span> <span class="sc">-</span>DNDEBUG   <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/Rcpp/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/unsupported"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/BH/include"</span> <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/src/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppParallel/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/rstan/include"</span> <span class="sc">-</span>DEIGEN_NO_DEBUG  <span class="sc">-</span>DBOOST_DISABLE_ASSERTS  <span class="sc">-</span>DBOOST_PENDING_INTEGER_LOG2_HPP  <span class="sc">-</span>DSTAN_THREADS  <span class="sc">-</span>DUSE_STANC3 <span class="sc">-</span>DSTRICT_R_HEADERS  <span class="sc">-</span>DBOOST_PHOENIX_NO_VARIADIC_EXPRESSION  <span class="sc">-</span>D_HAS_AUTO_PTR_ETC<span class="ot">=</span><span class="dv">0</span>  <span class="sc">-</span>include <span class="st">'/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp'</span>  <span class="sc">-</span>D_REENTRANT <span class="sc">-</span>DRCPP_PARALLEL_USE_TBB<span class="ot">=</span><span class="dv">1</span>   <span class="sc">-</span>I<span class="sc">/</span>opt<span class="sc">/</span>R<span class="sc">/</span>arm64<span class="sc">/</span>include    <span class="sc">-</span>fPIC  <span class="sc">-</span>falign<span class="sc">-</span>functions<span class="ot">=</span><span class="dv">64</span> <span class="sc">-</span>Wall <span class="sc">-</span>g <span class="sc">-</span>O2  <span class="sc">-</span>c foo.c <span class="sc">-</span>o foo.o</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>In file included from <span class="sc">&lt;</span>built<span class="sc">-</span><span class="cf">in</span><span class="sc">&gt;</span><span class="er">:</span><span class="dv">1</span><span class="sc">:</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22:</span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/Dense:1:</span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/Core:19:</span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a><span class="co">#&gt; /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:679:10: fatal error: 'cmath' file not found</span></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="co">#&gt;   679 | #include &lt;cmath&gt;</span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="co">#&gt;       |          ^~~~~~~</span></span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a>\</span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a><span class="dv">1</span> error generated.</span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a><span class="sc">|</span></span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a>make<span class="sc">:</span> <span class="er">***</span> [foo.o] Error <span class="dv">1</span></span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a><span class="sc">/</span></span>
<span id="cb17-34"><a href="#cb17-34" tabindex="-1"></a></span>
<span id="cb17-35"><a href="#cb17-35" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb17-36"><a href="#cb17-36" tabindex="-1"></a></span>
<span id="cb17-37"><a href="#cb17-37" tabindex="-1"></a> </span>
<span id="cb17-38"><a href="#cb17-38" tabindex="-1"></a><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).</span></span>
<span id="cb17-39"><a href="#cb17-39" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb17-40"><a href="#cb17-40" tabindex="-1"></a><span class="co">#&gt; Chain 1: Gradient evaluation took 7.3e-05 seconds</span></span>
<span id="cb17-41"><a href="#cb17-41" tabindex="-1"></a><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.73 seconds.</span></span>
<span id="cb17-42"><a href="#cb17-42" tabindex="-1"></a><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb17-43"><a href="#cb17-43" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb17-44"><a href="#cb17-44" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb17-45"><a href="#cb17-45" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)</span></span>
<span id="cb17-46"><a href="#cb17-46" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)</span></span>
<span id="cb17-47"><a href="#cb17-47" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)</span></span>
<span id="cb17-48"><a href="#cb17-48" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)</span></span>
<span id="cb17-49"><a href="#cb17-49" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)</span></span>
<span id="cb17-50"><a href="#cb17-50" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)</span></span>
<span id="cb17-51"><a href="#cb17-51" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)</span></span>
<span id="cb17-52"><a href="#cb17-52" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)</span></span>
<span id="cb17-53"><a href="#cb17-53" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)</span></span>
<span id="cb17-54"><a href="#cb17-54" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)</span></span>
<span id="cb17-55"><a href="#cb17-55" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)</span></span>
<span id="cb17-56"><a href="#cb17-56" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)</span></span>
<span id="cb17-57"><a href="#cb17-57" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb17-58"><a href="#cb17-58" tabindex="-1"></a><span class="co">#&gt; Chain 1:  Elapsed Time: 0.483 seconds (Warm-up)</span></span>
<span id="cb17-59"><a href="#cb17-59" tabindex="-1"></a><span class="co">#&gt; Chain 1:                0.602 seconds (Sampling)</span></span>
<span id="cb17-60"><a href="#cb17-60" tabindex="-1"></a><span class="co">#&gt; Chain 1:                1.085 seconds (Total)</span></span>
<span id="cb17-61"><a href="#cb17-61" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb17-62"><a href="#cb17-62" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-63"><a href="#cb17-63" tabindex="-1"></a><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).</span></span>
<span id="cb17-64"><a href="#cb17-64" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb17-65"><a href="#cb17-65" tabindex="-1"></a><span class="co">#&gt; Chain 2: Gradient evaluation took 3.2e-05 seconds</span></span>
<span id="cb17-66"><a href="#cb17-66" tabindex="-1"></a><span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.32 seconds.</span></span>
<span id="cb17-67"><a href="#cb17-67" tabindex="-1"></a><span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span></span>
<span id="cb17-68"><a href="#cb17-68" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb17-69"><a href="#cb17-69" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb17-70"><a href="#cb17-70" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)</span></span>
<span id="cb17-71"><a href="#cb17-71" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 100 / 1000 [ 10%]  (Warmup)</span></span>
<span id="cb17-72"><a href="#cb17-72" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 200 / 1000 [ 20%]  (Warmup)</span></span>
<span id="cb17-73"><a href="#cb17-73" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 300 / 1000 [ 30%]  (Warmup)</span></span>
<span id="cb17-74"><a href="#cb17-74" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 400 / 1000 [ 40%]  (Warmup)</span></span>
<span id="cb17-75"><a href="#cb17-75" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 500 / 1000 [ 50%]  (Warmup)</span></span>
<span id="cb17-76"><a href="#cb17-76" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 501 / 1000 [ 50%]  (Sampling)</span></span>
<span id="cb17-77"><a href="#cb17-77" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 600 / 1000 [ 60%]  (Sampling)</span></span>
<span id="cb17-78"><a href="#cb17-78" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 700 / 1000 [ 70%]  (Sampling)</span></span>
<span id="cb17-79"><a href="#cb17-79" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 800 / 1000 [ 80%]  (Sampling)</span></span>
<span id="cb17-80"><a href="#cb17-80" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 900 / 1000 [ 90%]  (Sampling)</span></span>
<span id="cb17-81"><a href="#cb17-81" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)</span></span>
<span id="cb17-82"><a href="#cb17-82" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb17-83"><a href="#cb17-83" tabindex="-1"></a><span class="co">#&gt; Chain 2:  Elapsed Time: 0.504 seconds (Warm-up)</span></span>
<span id="cb17-84"><a href="#cb17-84" tabindex="-1"></a><span class="co">#&gt; Chain 2:                0.323 seconds (Sampling)</span></span>
<span id="cb17-85"><a href="#cb17-85" tabindex="-1"></a><span class="co">#&gt; Chain 2:                0.827 seconds (Total)</span></span>
<span id="cb17-86"><a href="#cb17-86" tabindex="-1"></a><span class="co">#&gt; Chain 2:</span></span></code></pre></div>
<p>And the resulting reconstructions are as follow:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PredsBay</span></span>
<span><span class="co">#&gt;     Sample D47 D47error  meanTemp     error</span></span>
<span><span class="co">#&gt; 1 Sample 1 0.6    0.005  59.89768  7.554504</span></span>
<span><span class="co">#&gt; 2 Sample 2 0.7    0.005  18.46968  4.966526</span></span>
<span><span class="co">#&gt; 3 Sample 3 0.8    0.005 -10.52275  3.739295</span></span>
<span><span class="co">#&gt; 4 Sample 4 0.6    0.010  59.98475  8.727259</span></span>
<span><span class="co">#&gt; 5 Sample 5 0.7    0.010  18.53053  5.826769</span></span>
<span><span class="co">#&gt; 6 Sample 6 0.8    0.010 -10.48592  4.321455</span></span>
<span><span class="co">#&gt; 7 Sample 7 0.6    0.020  60.34881 12.441000</span></span>
<span><span class="co">#&gt; 8 Sample 8 0.7    0.020  18.69268  8.301508</span></span>
<span><span class="co">#&gt; 9 Sample 9 0.8    0.020 -10.40590  6.106598</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="including-a-co-variate-without-error-in-the-covariate">Including a co-variate (without error in the covariate)<a class="anchor" aria-label="anchor" href="#including-a-co-variate-without-error-in-the-covariate"></a>
</h2>
<p>We will now do the same for the models outlined above but ignoring
uncertainty in the covariate (Ion):</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">cal.dataset</span>(<span class="at">error =</span> <span class="st">"S1"</span>, <span class="at">nobs =</span> <span class="dv">50</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>ds<span class="sc">$</span>Ion <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(ds))</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>ionmodel <span class="ot">&lt;-</span> <span class="fu">cal.ion.bayesian</span>(<span class="at">calibrationData =</span> ds, <span class="at">useIonError =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co">#&gt; Trying to compile a simple C file</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">#&gt; Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>\</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>using C compiler<span class="sc">:</span> ‘Apple clang version <span class="dv">17</span>.<span class="fl">0.0</span> (clang<span class="dv">-1700</span>.<span class="dv">0</span>.<span class="fl">13.5</span>)’</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="sc">|</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>using SDK<span class="sc">:</span> ‘MacOSX15.<span class="fl">5.</span>sdk’</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="sc">/</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a>clang <span class="sc">-</span>arch arm64 <span class="sc">-</span>std<span class="ot">=</span>gnu2x <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Resources/include"</span> <span class="sc">-</span>DNDEBUG   <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/Rcpp/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/unsupported"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/BH/include"</span> <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/src/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppParallel/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/rstan/include"</span> <span class="sc">-</span>DEIGEN_NO_DEBUG  <span class="sc">-</span>DBOOST_DISABLE_ASSERTS  <span class="sc">-</span>DBOOST_PENDING_INTEGER_LOG2_HPP  <span class="sc">-</span>DSTAN_THREADS  <span class="sc">-</span>DUSE_STANC3 <span class="sc">-</span>DSTRICT_R_HEADERS  <span class="sc">-</span>DBOOST_PHOENIX_NO_VARIADIC_EXPRESSION  <span class="sc">-</span>D_HAS_AUTO_PTR_ETC<span class="ot">=</span><span class="dv">0</span>  <span class="sc">-</span>include <span class="st">'/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp'</span>  <span class="sc">-</span>D_REENTRANT <span class="sc">-</span>DRCPP_PARALLEL_USE_TBB<span class="ot">=</span><span class="dv">1</span>   <span class="sc">-</span>I<span class="sc">/</span>opt<span class="sc">/</span>R<span class="sc">/</span>arm64<span class="sc">/</span>include    <span class="sc">-</span>fPIC  <span class="sc">-</span>falign<span class="sc">-</span>functions<span class="ot">=</span><span class="dv">64</span> <span class="sc">-</span>Wall <span class="sc">-</span>g <span class="sc">-</span>O2  <span class="sc">-</span>c foo.c <span class="sc">-</span>o foo.o</span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a>In file included from <span class="sc">&lt;</span>built<span class="sc">-</span><span class="cf">in</span><span class="sc">&gt;</span><span class="er">:</span><span class="dv">1</span><span class="sc">:</span></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22:</span></span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/Dense:1:</span></span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/Core:19:</span></span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a><span class="co">#&gt; /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:679:10: fatal error: 'cmath' file not found</span></span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a><span class="co">#&gt;   679 | #include &lt;cmath&gt;</span></span>
<span id="cb19-25"><a href="#cb19-25" tabindex="-1"></a><span class="co">#&gt;       |          ^~~~~~~</span></span>
<span id="cb19-26"><a href="#cb19-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-27"><a href="#cb19-27" tabindex="-1"></a>\</span>
<span id="cb19-28"><a href="#cb19-28" tabindex="-1"></a><span class="dv">1</span> error generated.</span>
<span id="cb19-29"><a href="#cb19-29" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-30"><a href="#cb19-30" tabindex="-1"></a><span class="sc">|</span></span>
<span id="cb19-31"><a href="#cb19-31" tabindex="-1"></a>make<span class="sc">:</span> <span class="er">***</span> [foo.o] Error <span class="dv">1</span></span>
<span id="cb19-32"><a href="#cb19-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-33"><a href="#cb19-33" tabindex="-1"></a><span class="sc">/</span></span>
<span id="cb19-34"><a href="#cb19-34" tabindex="-1"></a></span>
<span id="cb19-35"><a href="#cb19-35" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb19-36"><a href="#cb19-36" tabindex="-1"></a></span>
<span id="cb19-37"><a href="#cb19-37" tabindex="-1"></a> </span>
<span id="cb19-38"><a href="#cb19-38" tabindex="-1"></a>ionmodel</span>
<span id="cb19-39"><a href="#cb19-39" tabindex="-1"></a><span class="co">#&gt; $BLM1_fit</span></span>
<span id="cb19-40"><a href="#cb19-40" tabindex="-1"></a><span class="co">#&gt; Inference for Stan model: anon_model.</span></span>
<span id="cb19-41"><a href="#cb19-41" tabindex="-1"></a><span class="co">#&gt; 2 chains, each with iter=2500; warmup=1000; thin=1; </span></span>
<span id="cb19-42"><a href="#cb19-42" tabindex="-1"></a><span class="co">#&gt; post-warmup draws per chain=1500, total post-warmup draws=3000.</span></span>
<span id="cb19-43"><a href="#cb19-43" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-44"><a href="#cb19-44" tabindex="-1"></a><span class="co">#&gt;         mean se_mean   sd   2.5%    25%    50%    75%  97.5% n_eff Rhat</span></span>
<span id="cb19-45"><a href="#cb19-45" tabindex="-1"></a><span class="co">#&gt; alpha   0.27    0.00 0.01   0.25   0.26   0.27   0.28   0.30  2908    1</span></span>
<span id="cb19-46"><a href="#cb19-46" tabindex="-1"></a><span class="co">#&gt; beta    0.04    0.00 0.00   0.03   0.04   0.04   0.04   0.04  2931    1</span></span>
<span id="cb19-47"><a href="#cb19-47" tabindex="-1"></a><span class="co">#&gt; gamma   0.00    0.00 0.00   0.00   0.00   0.00   0.00   0.00  5064    1</span></span>
<span id="cb19-48"><a href="#cb19-48" tabindex="-1"></a><span class="co">#&gt; sigma   0.01    0.00 0.00   0.01   0.01   0.01   0.01   0.02  2766    1</span></span>
<span id="cb19-49"><a href="#cb19-49" tabindex="-1"></a><span class="co">#&gt; lp__  136.05    0.14 5.24 124.71 132.76 136.44 139.86 145.28  1500    1</span></span>
<span id="cb19-50"><a href="#cb19-50" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-51"><a href="#cb19-51" tabindex="-1"></a><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Tue Jul 22 08:03:35 2025.</span></span>
<span id="cb19-52"><a href="#cb19-52" tabindex="-1"></a><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span id="cb19-53"><a href="#cb19-53" tabindex="-1"></a><span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span></span>
<span id="cb19-54"><a href="#cb19-54" tabindex="-1"></a><span class="co">#&gt; convergence, Rhat=1).</span></span></code></pre></div>
<p>From here, we can just run the reconstructions</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>recData <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample =</span> <span class="fu">paste</span>(<span class="st">"Sample"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>),</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>                      <span class="at">D47 =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>), <span class="dv">3</span>),</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>                      <span class="at">D47error =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.005</span>,<span class="dv">3</span>), <span class="fu">rep</span>(<span class="fl">0.01</span>,<span class="dv">3</span>), <span class="fu">rep</span>(<span class="fl">0.02</span>,<span class="dv">3</span>)),</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>                      <span class="at">Ion =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>), <span class="dv">3</span>),</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>                      <span class="at">N =</span> <span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">9</span>),</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>                      <span class="at">Material =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">9</span>))</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>PredsBay <span class="ot">&lt;-</span> <span class="fu">rec.ion.bayesian</span>(<span class="at">calModel =</span> ionmodel[[<span class="dv">1</span>]],</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>                             <span class="at">recData =</span> recData,</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>                             <span class="at">iter =</span> <span class="dv">1000</span>,</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>                             <span class="at">postcalsamples =</span> <span class="dv">100</span>, <span class="at">MC =</span> <span class="cn">FALSE</span>,</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>                             <span class="at">useIonError =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="co">#&gt; Trying to compile a simple C file</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="co">#&gt; Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a>using C compiler<span class="sc">:</span> ‘Apple clang version <span class="dv">17</span>.<span class="fl">0.0</span> (clang<span class="dv">-1700</span>.<span class="dv">0</span>.<span class="fl">13.5</span>)’</span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>\</span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>using SDK<span class="sc">:</span> ‘MacOSX15.<span class="fl">5.</span>sdk’</span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a><span class="sc">|</span></span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a>clang <span class="sc">-</span>arch arm64 <span class="sc">-</span>std<span class="ot">=</span>gnu2x <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Resources/include"</span> <span class="sc">-</span>DNDEBUG   <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/Rcpp/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/unsupported"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/BH/include"</span> <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/src/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppParallel/include/"</span>  <span class="sc">-</span>I<span class="st">"/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/rstan/include"</span> <span class="sc">-</span>DEIGEN_NO_DEBUG  <span class="sc">-</span>DBOOST_DISABLE_ASSERTS  <span class="sc">-</span>DBOOST_PENDING_INTEGER_LOG2_HPP  <span class="sc">-</span>DSTAN_THREADS  <span class="sc">-</span>DUSE_STANC3 <span class="sc">-</span>DSTRICT_R_HEADERS  <span class="sc">-</span>DBOOST_PHOENIX_NO_VARIADIC_EXPRESSION  <span class="sc">-</span>D_HAS_AUTO_PTR_ETC<span class="ot">=</span><span class="dv">0</span>  <span class="sc">-</span>include <span class="st">'/Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp'</span>  <span class="sc">-</span>D_REENTRANT <span class="sc">-</span>DRCPP_PARALLEL_USE_TBB<span class="ot">=</span><span class="dv">1</span>   <span class="sc">-</span>I<span class="sc">/</span>opt<span class="sc">/</span>R<span class="sc">/</span>arm64<span class="sc">/</span>include    <span class="sc">-</span>fPIC  <span class="sc">-</span>falign<span class="sc">-</span>functions<span class="ot">=</span><span class="dv">64</span> <span class="sc">-</span>Wall <span class="sc">-</span>g <span class="sc">-</span>O2  <span class="sc">-</span>c foo.c <span class="sc">-</span>o foo.o</span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a><span class="sc">/</span></span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a>In file included from <span class="sc">&lt;</span>built<span class="sc">-</span><span class="cf">in</span><span class="sc">&gt;</span><span class="er">:</span><span class="dv">1</span><span class="sc">:</span></span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22:</span></span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/Dense:1:</span></span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a><span class="co">#&gt; In file included from /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/Core:19:</span></span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a><span class="co">#&gt; /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library/RcppEigen/include/Eigen/src/Core/util/Macros.h:679:10: fatal error: 'cmath' file not found</span></span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a><span class="co">#&gt;   679 | #include &lt;cmath&gt;</span></span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a><span class="co">#&gt;       |          ^~~~~~~</span></span>
<span id="cb20-33"><a href="#cb20-33" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-34"><a href="#cb20-34" tabindex="-1"></a><span class="sc">-</span></span>
<span id="cb20-35"><a href="#cb20-35" tabindex="-1"></a><span class="dv">1</span> error generated.</span>
<span id="cb20-36"><a href="#cb20-36" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-37"><a href="#cb20-37" tabindex="-1"></a>\</span>
<span id="cb20-38"><a href="#cb20-38" tabindex="-1"></a>make<span class="sc">:</span> <span class="er">***</span> [foo.o] Error <span class="dv">1</span></span>
<span id="cb20-39"><a href="#cb20-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-40"><a href="#cb20-40" tabindex="-1"></a><span class="sc">|</span></span>
<span id="cb20-41"><a href="#cb20-41" tabindex="-1"></a></span>
<span id="cb20-42"><a href="#cb20-42" tabindex="-1"></a><span class="er">/</span></span>
<span id="cb20-43"><a href="#cb20-43" tabindex="-1"></a></span>
<span id="cb20-44"><a href="#cb20-44" tabindex="-1"></a> </span>
<span id="cb20-45"><a href="#cb20-45" tabindex="-1"></a><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).</span></span>
<span id="cb20-46"><a href="#cb20-46" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb20-47"><a href="#cb20-47" tabindex="-1"></a><span class="co">#&gt; Chain 1: Gradient evaluation took 0.0001 seconds</span></span>
<span id="cb20-48"><a href="#cb20-48" tabindex="-1"></a><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 1 seconds.</span></span>
<span id="cb20-49"><a href="#cb20-49" tabindex="-1"></a><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb20-50"><a href="#cb20-50" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb20-51"><a href="#cb20-51" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb20-52"><a href="#cb20-52" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)</span></span>
<span id="cb20-53"><a href="#cb20-53" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)</span></span>
<span id="cb20-54"><a href="#cb20-54" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)</span></span>
<span id="cb20-55"><a href="#cb20-55" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)</span></span>
<span id="cb20-56"><a href="#cb20-56" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)</span></span>
<span id="cb20-57"><a href="#cb20-57" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)</span></span>
<span id="cb20-58"><a href="#cb20-58" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)</span></span>
<span id="cb20-59"><a href="#cb20-59" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)</span></span>
<span id="cb20-60"><a href="#cb20-60" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)</span></span>
<span id="cb20-61"><a href="#cb20-61" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)</span></span>
<span id="cb20-62"><a href="#cb20-62" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)</span></span>
<span id="cb20-63"><a href="#cb20-63" tabindex="-1"></a><span class="co">#&gt; Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)</span></span>
<span id="cb20-64"><a href="#cb20-64" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb20-65"><a href="#cb20-65" tabindex="-1"></a><span class="co">#&gt; Chain 1:  Elapsed Time: 0.478 seconds (Warm-up)</span></span>
<span id="cb20-66"><a href="#cb20-66" tabindex="-1"></a><span class="co">#&gt; Chain 1:                0.319 seconds (Sampling)</span></span>
<span id="cb20-67"><a href="#cb20-67" tabindex="-1"></a><span class="co">#&gt; Chain 1:                0.797 seconds (Total)</span></span>
<span id="cb20-68"><a href="#cb20-68" tabindex="-1"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb20-69"><a href="#cb20-69" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-70"><a href="#cb20-70" tabindex="-1"></a><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).</span></span>
<span id="cb20-71"><a href="#cb20-71" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb20-72"><a href="#cb20-72" tabindex="-1"></a><span class="co">#&gt; Chain 2: Gradient evaluation took 2.9e-05 seconds</span></span>
<span id="cb20-73"><a href="#cb20-73" tabindex="-1"></a><span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.29 seconds.</span></span>
<span id="cb20-74"><a href="#cb20-74" tabindex="-1"></a><span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span></span>
<span id="cb20-75"><a href="#cb20-75" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb20-76"><a href="#cb20-76" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb20-77"><a href="#cb20-77" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)</span></span>
<span id="cb20-78"><a href="#cb20-78" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 100 / 1000 [ 10%]  (Warmup)</span></span>
<span id="cb20-79"><a href="#cb20-79" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 200 / 1000 [ 20%]  (Warmup)</span></span>
<span id="cb20-80"><a href="#cb20-80" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 300 / 1000 [ 30%]  (Warmup)</span></span>
<span id="cb20-81"><a href="#cb20-81" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 400 / 1000 [ 40%]  (Warmup)</span></span>
<span id="cb20-82"><a href="#cb20-82" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 500 / 1000 [ 50%]  (Warmup)</span></span>
<span id="cb20-83"><a href="#cb20-83" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 501 / 1000 [ 50%]  (Sampling)</span></span>
<span id="cb20-84"><a href="#cb20-84" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 600 / 1000 [ 60%]  (Sampling)</span></span>
<span id="cb20-85"><a href="#cb20-85" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 700 / 1000 [ 70%]  (Sampling)</span></span>
<span id="cb20-86"><a href="#cb20-86" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 800 / 1000 [ 80%]  (Sampling)</span></span>
<span id="cb20-87"><a href="#cb20-87" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 900 / 1000 [ 90%]  (Sampling)</span></span>
<span id="cb20-88"><a href="#cb20-88" tabindex="-1"></a><span class="co">#&gt; Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)</span></span>
<span id="cb20-89"><a href="#cb20-89" tabindex="-1"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb20-90"><a href="#cb20-90" tabindex="-1"></a><span class="co">#&gt; Chain 2:  Elapsed Time: 0.502 seconds (Warm-up)</span></span>
<span id="cb20-91"><a href="#cb20-91" tabindex="-1"></a><span class="co">#&gt; Chain 2:                0.596 seconds (Sampling)</span></span>
<span id="cb20-92"><a href="#cb20-92" tabindex="-1"></a><span class="co">#&gt; Chain 2:                1.098 seconds (Total)</span></span>
<span id="cb20-93"><a href="#cb20-93" tabindex="-1"></a><span class="co">#&gt; Chain 2:</span></span>
<span id="cb20-94"><a href="#cb20-94" tabindex="-1"></a></span>
<span id="cb20-95"><a href="#cb20-95" tabindex="-1"></a>PredsBay</span>
<span id="cb20-96"><a href="#cb20-96" tabindex="-1"></a><span class="co">#&gt;     Sample D47 D47error  meanTemp     error</span></span>
<span id="cb20-97"><a href="#cb20-97" tabindex="-1"></a><span class="co">#&gt; 1 Sample 1 0.6    0.005  60.01190  7.859567</span></span>
<span id="cb20-98"><a href="#cb20-98" tabindex="-1"></a><span class="co">#&gt; 2 Sample 2 0.7    0.005  18.48208  5.102999</span></span>
<span id="cb20-99"><a href="#cb20-99" tabindex="-1"></a><span class="co">#&gt; 3 Sample 3 0.8    0.005 -10.53734  3.798185</span></span>
<span id="cb20-100"><a href="#cb20-100" tabindex="-1"></a><span class="co">#&gt; 4 Sample 4 0.6    0.010  60.14399  9.053373</span></span>
<span id="cb20-101"><a href="#cb20-101" tabindex="-1"></a><span class="co">#&gt; 5 Sample 5 0.7    0.010  18.54175  5.853664</span></span>
<span id="cb20-102"><a href="#cb20-102" tabindex="-1"></a><span class="co">#&gt; 6 Sample 6 0.8    0.010 -10.51314  4.399987</span></span>
<span id="cb20-103"><a href="#cb20-103" tabindex="-1"></a><span class="co">#&gt; 7 Sample 7 0.6    0.020  60.38643 12.692343</span></span>
<span id="cb20-104"><a href="#cb20-104" tabindex="-1"></a><span class="co">#&gt; 8 Sample 8 0.7    0.020  18.72312  8.343830</span></span>
<span id="cb20-105"><a href="#cb20-105" tabindex="-1"></a><span class="co">#&gt; 9 Sample 9 0.8    0.020 -10.40656  6.197698</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="outlook">Outlook<a class="anchor" aria-label="anchor" href="#outlook"></a>
</h2>
<p>We have reviewed the most fundamental aspects of using
<code>bayclumpr</code>. More advances analyses involving alternative
priors in Bayesian models are an option.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cristian Roman Palacios, Hannah M. Carroll, Aradhna Tripati.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
